<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faculty Professional Development Funding Request - Muskingum University</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // SharePoint Configuration - UPDATE THIS WITH YOUR SITE URL
        const SHAREPOINT_SITE_URL = 'https://muskingum.sharepoint.com/sites/YourSiteName';
        const DEPT_CHAIRS_LIST = 'Department Chairs';
        
        // Mileage rate
        const MILEAGE_RATE = 0.70;
    </script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Calibri, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #DB0A5B;
            padding-bottom: 20px;
        }

        .header h1 {
            color: #DB0A5B;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            color: #DB0A5B;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #DB0A5B;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }

        .required {
            color: #DB0A5B;
        }

        input[type="text"],
        input[type="email"],
        input[type="date"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e1e1;
            border-radius: 4px;
            font-size: 14px;
            font-family: Calibri, sans-serif;
            transition: border-color 0.3s;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #DB0A5B;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .policy-link {
            display: inline-block;
            margin-top: 10px;
            color: #DB0A5B;
            text-decoration: none;
            font-weight: bold;
        }

        .policy-link:hover {
            text-decoration: underline;
        }

        .expense-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .expense-table th {
            background-color: #DB0A5B;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        .expense-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        .expense-table input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .expense-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .total-row {
            background-color: #f0f0f0 !important;
            font-weight: bold;
        }

        .total-row td {
            border-top: 2px solid #DB0A5B;
            padding: 15px 10px;
        }

        .submit-button {
            background-color: #DB0A5B;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            display: block;
            margin: 30px auto 0;
        }

        .submit-button:hover {
            background-color: #B00850;
        }

        .submit-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .validation-message {
            color: #DB0A5B;
            font-weight: bold;
            margin-top: 10px;
            padding: 10px;
            background-color: #ffe6f0;
            border-radius: 4px;
            display: none;
        }

        .success-message {
            color: #008000;
            font-weight: bold;
            margin-top: 10px;
            padding: 15px;
            background-color: #e6ffe6;
            border-radius: 4px;
            display: none;
            text-align: center;
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #DB0A5B;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        small {
            color: #666;
            font-size: 12px;
        }

        .chair-display {
            display: none;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 14px;
        }

        .chair-display.show {
            display: block;
        }

        .mileage-miles-input {
            border: 2px solid #DB0A5B !important;
        }

        .calculated-amount {
            color: #DB0A5B;
            font-weight: bold;
            font-size: 14px;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .expense-table {
                font-size: 12px;
            }
            
            .expense-table th,
            .expense-table td {
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Faculty Professional Development Funding Request</h1>
            <p>Muskingum University</p>
        </div>

        <form id="developmentFundForm">
            
            <!-- Faculty Information Section -->
            <div class="section">
                <h2 class="section-title">Faculty Information</h2>
                
                <div class="form-group">
                    <label for="facultyName">Faculty Name <span class="required">*</span></label>
                    <input type="text" id="facultyName" name="facultyName" required>
                </div>

                <div class="form-group">
                    <label for="department">Department <span class="required">*</span></label>
                    <select id="department" name="department" required>
                        <option value="">-- Select Your Department --</option>
                        <!-- Options will be loaded from SharePoint -->
                    </select>
                    <small>Loading departments from SharePoint...</small>
                </div>

                <!-- Hidden field for chair email -->
                <input type="hidden" id="chairEmail" name="chairEmail">

                <!-- Display selected chair (hidden initially) -->
                <div id="chairDisplay" class="chair-display">
                    <strong>Your request will be routed to your department chair for approval.</strong>
                </div>

                <div class="form-group">
                    <label for="submissionDate">Date of Submission <span class="required">*</span></label>
                    <input type="date" id="submissionDate" name="submissionDate" required>
                </div>
            </div>

            <!-- Policy Section -->
            <div class="section">
                <h2 class="section-title">Policy Information</h2>
                
                <div class="form-group">
                    <label for="eligibleActivities">
                        Which of the following types of activities make you eligible for this funding? 
                        <span class="required">*</span>
                    </label>
                    <textarea id="eligibleActivities" name="eligibleActivities" 
                              placeholder="Examples: Conference attendance, workshop participation, professional membership, research activities, etc." 
                              required></textarea>
                    <a href="Faculty-professional-development-policy-11.7.25.docx" target="_blank" class="policy-link">
                        üìÑ View Faculty Professional Development Policy
                    </a>
                </div>
            </div>

            <!-- Activity Details Section -->
            <div class="section">
                <h2 class="section-title">Activity Details</h2>
                
                <div class="form-group">
                    <label for="activityDescription">
                        Provide a description of the activity you intend to pursue 
                        <span class="required">*</span>
                    </label>
                    <textarea id="activityDescription" name="activityDescription" 
                              placeholder="Include dates, location, name of conference/workshop, etc." 
                              required></textarea>
                </div>

                <div class="form-group">
                    <label for="professionalValue">
                        Explain how this professional development activity will enhance your work as a faculty member 
                        <span class="required">*</span>
                    </label>
                    <textarea id="professionalValue" name="professionalValue" 
                              placeholder="Describe the professional value and benefits to your teaching, research, or service" 
                              required></textarea>
                </div>

                <div class="form-group">
                    <label for="classArrangements">
                        If this activity occurs during the academic year, how will your classes be covered?
                    </label>
                    <textarea id="classArrangements" name="classArrangements" 
                              placeholder="Describe arrangements for class coverage (if applicable)"></textarea>
                </div>
            </div>

            <!-- Budget Section -->
            <div class="section">
                <h2 class="section-title">Budget Breakdown</h2>
                <p style="margin-bottom: 15px;">
                    <strong>Maximum funding:</strong> $1,000 per fiscal year<br>
                    <small>Enter anticipated costs before the activity and actual costs after completion.</small>
                </p>

                <table class="expense-table">
                    <thead>
                        <tr>
                            <th>Expense Category</th>
                            <th>Anticipated</th>
                            <th>Actual</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Membership Dues <small>(max $200)</small></td>
                            <td><input type="number" step="0.01" min="0" max="200" id="membershipDues" name="membershipDues" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" max="200" id="membershipDuesActual" name="membershipDuesActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr>
                            <td>Air Travel</td>
                            <td><input type="number" step="0.01" min="0" id="airTravel" name="airTravel" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" id="airTravelActual" name="airTravelActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr>
                            <td>Mileage <small>($0.70 per mile)</small></td>
                            <td>
                                <div style="display: flex; flex-direction: column; gap: 5px;">
                                    <input type="number" step="1" min="0" id="mileageMiles" name="mileageMiles" value="0" placeholder="Enter miles" class="mileage-miles-input">
                                    <div class="calculated-amount">= $<span id="mileageCalc">0.00</span></div>
                                    <input type="hidden" id="mileage" name="mileage" value="0" class="expense-input-anticipated">
                                </div>
                            </td>
                            <td>
                                <div style="display: flex; flex-direction: column; gap: 5px;">
                                    <input type="number" step="1" min="0" id="mileageActualMiles" name="mileageActualMiles" value="0" placeholder="Enter miles" class="mileage-miles-input">
                                    <div class="calculated-amount">= $<span id="mileageActualCalc">0.00</span></div>
                                    <input type="hidden" id="mileageActual" name="mileageActual" value="0" class="expense-input-actual">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Other Ground Travel</td>
                            <td><input type="number" step="0.01" min="0" id="groundTravel" name="groundTravel" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" id="groundTravelActual" name="groundTravelActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr>
                            <td>Registration Costs</td>
                            <td><input type="number" step="0.01" min="0" id="registrationCosts" name="registrationCosts" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" id="registrationCostsActual" name="registrationCostsActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr>
                            <td>Lodging</td>
                            <td><input type="number" step="0.01" min="0" id="lodging" name="lodging" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" id="lodgingActual" name="lodgingActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr>
                            <td>Meals & Incidentals</td>
                            <td><input type="number" step="0.01" min="0" id="mealsIncidentals" name="mealsIncidentals" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" id="mealsIncidentalsActual" name="mealsIncidentalsActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr>
                            <td>
                                Other Expense<br>
                                <input type="text" id="otherExpenseDesc" name="otherExpenseDesc" placeholder="Describe other expense" style="margin-top:5px; font-size:12px;">
                            </td>
                            <td><input type="number" step="0.01" min="0" id="otherExpense" name="otherExpense" value="0" class="expense-input-anticipated"></td>
                            <td><input type="number" step="0.01" min="0" id="otherExpenseActual" name="otherExpenseActual" value="0" class="expense-input-actual"></td>
                        </tr>
                        <tr class="total-row">
                            <td><strong>TOTAL</strong></td>
                            <td><strong>$<span id="totalAnticipated">0.00</span></strong></td>
                            <td><strong>$<span id="totalActual">0.00</span></strong></td>
                        </tr>
                    </tbody>
                </table>

                <div id="validationMessage" class="validation-message"></div>
            </div>

            <!-- Signature Section -->
            <div class="section">
                <h2 class="section-title">Signature</h2>
                
                <div class="form-group">
                    <label for="facultySignature">
                        Faculty Member Signature (Type your full name) <span class="required">*</span>
                    </label>
                    <input type="text" id="facultySignature" name="facultySignature" 
                           placeholder="Type your full name as electronic signature" required>
                    <small>By typing your name, you certify that the information provided is accurate and complete.</small>
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="submit-button" id="submitBtn">Submit Request</button>

            <!-- Loading indicator -->
            <div class="loading" id="loading">
                <div class="loading-spinner"></div>
                <p>Submitting your request...</p>
            </div>

            <!-- Success message -->
            <div class="success-message" id="successMessage"></div>

        </form>
    </div>

    <script>
        // Load department chairs from SharePoint on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDepartmentChairs();
            initializeMileageCalculator();
            initializeExpenseCalculator();
            setDefaultDate();
        });

        // Load department chairs from SharePoint
        async function loadDepartmentChairs() {
            try {
                const apiUrl = `${SHAREPOINT_SITE_URL}/_api/web/lists/getbytitle('${DEPT_CHAIRS_LIST}')/items?$select=Department,ChairEmail&$orderby=Department`;
                
                const response = await fetch(apiUrl, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json;odata=verbose'
                    },
                    credentials: 'include'
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch department chairs');
                }

                const data = await response.json();
                const chairs = data.d.results;

                const departmentSelect = document.getElementById('department');
                
                // Clear loading message
                departmentSelect.nextElementSibling.textContent = '';

                // Populate dropdown
                chairs.forEach(chair => {
                    const option = document.createElement('option');
                    option.value = chair.Department;
                    option.textContent = chair.Department;
                    option.setAttribute('data-email', chair.ChairEmail);
                    departmentSelect.appendChild(option);
                });

                // Add change event listener
                departmentSelect.addEventListener('change', function() {
                    const selectedOption = this.options[this.selectedIndex];
                    const chairDisplay = document.getElementById('chairDisplay');
                    
                    if (selectedOption.value) {
                        const chairEmail = selectedOption.getAttribute('data-email');
                        document.getElementById('chairEmail').value = chairEmail;
                        chairDisplay.classList.add('show');
                    } else {
                        chairDisplay.classList.remove('show');
                        document.getElementById('chairEmail').value = '';
                    }
                });

            } catch (error) {
                console.error('Error loading department chairs:', error);
                
                // Fallback: Show static list of departments
                const fallbackDepts = [
                    {Name: "Amanda Adams", email: "aeadams@muskingum.edu"},
                    {Name: "Brian Bergstrom", email: "brianb@muskingum.edu"},
                    {Name: "Cassie King", email: "caking@muskingum.edu"},
                    {Name: "Colleen Stevenson", email: "colleens@muskingum.edu"},
                    {Name: "Daniel Strycha", email: "dstrycha@muskingum.edu"},
                    {Name: "Hallie Baker", email: "hallieb@muskingum.edu"},
                    {Name: "Jason Kehrberg", email: "jasonk@muskingum.edu"},
                    {Name: "Jean-Francois Mondon", email: "jmondon@muskingum.edu"},
                    {Name: "Jim Dooley", email: "jdooley@muskingum.edu"},
                    {Name: "Joe Shaffer", email: "shaeffer@muskingum.edu"},
                    {Name: "Keith Eberly", email: "keberly@muskingum.edu"},
                    {Name: "Laura Geiger", email: "lgeiger@muskingum.edu"},
                    {Name: "Lois Zook", email: "lzook@muskingum.edu"},
                    {Name: "Melissa Conroy", email: "mconroy@muskingum.edu"},
                    {Name: "Richard Daquila", email: "rdaquila@muskingum.edu"},
                    {Name: "Richard Taylor", email: "richardt@muskingum.edu},
                    {Name: "Rob Sharp", email: "rsharp@muskingum.edu"},
                    {Name: "Seth Barret", email: "sbarrett@muskingum.edu"},
                    {Name: "Tiffany Lough", email: "tiffanyf@muskingum.edu"},
                    {Name: "Tom German", email: "tgerman@muskingum.edu"},
                    {Name: "Tom McGrath", email: "tmcgrath@muskingum.edu"}
                ];

                const departmentSelect = document.getElementById('department');
                departmentSelect.nextElementSibling.textContent = 'Using cached department list';
                
                fallbackDepts.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.dept;
                    option.textContent = item.dept;
                    option.setAttribute('data-email', item.email);
                    departmentSelect.appendChild(option);
                });

                // Add change event listener for fallback
                departmentSelect.addEventListener('change', function() {
                    const selectedOption = this.options[this.selectedIndex];
                    const chairDisplay = document.getElementById('chairDisplay');
                    
                    if (selectedOption.value) {
                        const chairEmail = selectedOption.getAttribute('data-email');
                        document.getElementById('chairEmail').value = chairEmail;
                        chairDisplay.classList.add('show');
                    } else {
                        chairDisplay.classList.remove('show');
                        document.getElementById('chairEmail').value = '';
                    }
                });
            }
        }

        // Initialize mileage calculator
        function initializeMileageCalculator() {
            const mileageAnticipatedInput = document.getElementById('mileageMiles');
            const mileageActualInput = document.getElementById('mileageActualMiles');
            
            mileageAnticipatedInput.addEventListener('input', function() {
                const miles = parseFloat(this.value) || 0;
                const dollars = miles * MILEAGE_RATE;
                document.getElementById('mileageCalc').textContent = dollars.toFixed(2);
                document.getElementById('mileage').value = dollars.toFixed(2);
                calculateTotals();
            });
            
            mileageActualInput.addEventListener('input', function() {
                const miles = parseFloat(this.value) || 0;
                const dollars = miles * MILEAGE_RATE;
                document.getElementById('mileageActualCalc').textContent = dollars.toFixed(2);
                document.getElementById('mileageActual').value = dollars.toFixed(2);
                calculateTotals();
            });
        }

        // Initialize expense calculator
        function initializeExpenseCalculator() {
            const anticipatedInputs = document.querySelectorAll('.expense-input-anticipated');
            const actualInputs = document.querySelectorAll('.expense-input-actual');
            
            anticipatedInputs.forEach(input => {
                input.addEventListener('input', calculateTotals);
            });
            
            actualInputs.forEach(input => {
                input.addEventListener('input', calculateTotals);
            });
        }

        // Calculate totals
        function calculateTotals() {
            const anticipatedInputs = document.querySelectorAll('.expense-input-anticipated');
            const actualInputs = document.querySelectorAll('.expense-input-actual');
            
            let anticipatedTotal = 0;
            let actualTotal = 0;
            
            anticipatedInputs.forEach(input => {
                anticipatedTotal += parseFloat(input.value) || 0;
            });
            
            actualInputs.forEach(input => {
                actualTotal += parseFloat(input.value) || 0;
            });
            
            document.getElementById('totalAnticipated').textContent = anticipatedTotal.toFixed(2);
            document.getElementById('totalActual').textContent = actualTotal.toFixed(2);
            
            // Validate $1000 maximum
            const validationMessage = document.getElementById('validationMessage');
            if (anticipatedTotal > 1000) {
                validationMessage.textContent = '‚ö†Ô∏è Warning: Anticipated total exceeds the $1,000 maximum funding limit.';
                validationMessage.style.display = 'block';
            } else {
                validationMessage.style.display = 'none';
            }
        }

        // Set default date to today
        function setDefaultDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('submissionDate').value = today;
        }

        // Form submission
        document.getElementById('developmentFundForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate required fields
            if (!this.checkValidity()) {
                alert('Please fill out all required fields.');
                return;
            }

            // Check if chair email is populated
            const chairEmail = document.getElementById('chairEmail').value;
            if (!chairEmail) {
                alert('Please select a department.');
                return;
            }

            // Show loading
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('loading').style.display = 'block';
            
            // Gather form data using PascalCase to match SharePoint columns
            const formData = {
                FacultyName: document.getElementById('facultyName').value,
                Department: document.getElementById('department').value,
                ChairEmail: chairEmail,
                SubmissionDate: document.getElementById('submissionDate').value,
                EligibleActivities: document.getElementById('eligibleActivities').value,
                ActivityDescription: document.getElementById('activityDescription').value,
                ProfessionalValue: document.getElementById('professionalValue').value,
                ClassArrangements: document.getElementById('classArrangements').value,
                MembershipDues: parseFloat(document.getElementById('membershipDues').value) || 0,
                AirTravel: parseFloat(document.getElementById('airTravel').value) || 0,
                Mileage: parseFloat(document.getElementById('mileage').value) || 0,
                MileageMiles: parseFloat(document.getElementById('mileageMiles').value) || 0,
                GroundTravel: parseFloat(document.getElementById('groundTravel').value) || 0,
                RegistrationCosts: parseFloat(document.getElementById('registrationCosts').value) || 0,
                Lodging: parseFloat(document.getElementById('lodging').value) || 0,
                MealsIncidentals: parseFloat(document.getElementById('mealsIncidentals').value) || 0,
                OtherExpense: parseFloat(document.getElementById('otherExpense').value) || 0,
                OtherExpenseDesc: document.getElementById('otherExpenseDesc').value,
                TotalAnticipated: parseFloat(document.getElementById('totalAnticipated').textContent),
                MembershipDuesActual: parseFloat(document.getElementById('membershipDuesActual').value) || 0,
                AirTravelActual: parseFloat(document.getElementById('airTravelActual').value) || 0,
                MileageActual: parseFloat(document.getElementById('mileageActual').value) || 0,
                MileageActualMiles: parseFloat(document.getElementById('mileageActualMiles').value) || 0,
                GroundTravelActual: parseFloat(document.getElementById('groundTravelActual').value) || 0,
                RegistrationCostsActual: parseFloat(document.getElementById('registrationCostsActual').value) || 0,
                LodgingActual: parseFloat(document.getElementById('lodgingActual').value) || 0,
                MealsIncidentalsActual: parseFloat(document.getElementById('mealsIncidentalsActual').value) || 0,
                OtherExpenseActual: parseFloat(document.getElementById('otherExpenseActual').value) || 0,
                TotalActual: parseFloat(document.getElementById('totalActual').textContent),
                FacultySignature: document.getElementById('facultySignature').value
            };
            
            try {
                // UPDATE THIS WITH YOUR POWER AUTOMATE FLOW URL
                const flowUrl = 'YOUR_POWER_AUTOMATE_URL_HERE';
                
                const response = await axios.post(flowUrl, formData);
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
                // Show success message
                const successMessage = document.getElementById('successMessage');
                successMessage.innerHTML = `
                    <h3>‚úì Request Submitted Successfully!</h3>
                    <p>Your Faculty Development Fund request has been submitted.</p>
                    <p>You will receive a confirmation email shortly.</p>
                    <p>Your department chair will review your request and you'll be notified of the decision.</p>
                `;
                successMessage.style.display = 'block';
                
                // Reset form
                this.reset();
                document.getElementById('chairDisplay').classList.remove('show');
                calculateTotals();
                setDefaultDate();
                
                // Scroll to success message
                successMessage.scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('Submission error:', error);
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                document.getElementById('submitBtn').disabled = false;
                
                alert('Failed to submit request. Please try again or contact IT support if the problem persists.');
            }
        });
    </script>
</body>
</html>
